import React, { useContext, useEffect, useRef } from 'react';
import { animated } from 'react-spring';
import AvatarCenterContext from '../../contexts/AvatarCenter';
import SpringContext from '../../contexts/Spring';
import styles from './styles.module.scss';

const trans1 = (x, y) => `translate3d(${x}px,${y}px,0)`;
const trans2 = (x, y) => `translate3d(${x / 2}px,${y / 2}px,0)`;

const Avatar = () => {
  const { xy } = useContext(SpringContext);
  const { setCenter } = useContext(AvatarCenterContext);

  useEffect(() => {
    let { left, width, top, height } = ref.current.getBoundingClientRect();
    setCenter({ x: left + width / 2, y: top + height / 2 });
  }, []);

  const ref = useRef(null);

  return (
    <animated.svg
      style={{ transform: xy.to(trans2) }}
      width='264'
      height='280'
      viewBox='0 0 264 280'
      fill='none'
      xmlns='http://www.w3.org/2000/svg'
      className={styles.avatar}
      ref={ref}>
      <mask
        id='mask0'
        mask-type='alpha'
        maskUnits='userSpaceOnUse'
        x='12'
        y='40'
        width='240'
        height='240'>
        <path
          d='M132 280C198.274 280 252 226.274 252 160C252 93.7258 198.274 40 132 40C65.7258 40 12 93.7258 12 160C12 226.274 65.7258 280 132 280Z'
          fill='white'
        />
      </mask>
      <g mask='url(#mask0)'>
        <path
          d='M132 280C198.274 280 252 226.274 252 160C252 93.7258 198.274 40 132 40C65.7258 40 12 93.7258 12 160C12 226.274 65.7258 280 132 280Z'
          fill='#E6E6E6'
        />
        <path d='M252 40H12V280H252V40Z' className={styles.circle} />
      </g>
      <mask
        id='mask1'
        mask-type='alpha'
        maskUnits='userSpaceOnUse'
        x='0'
        y='0'
        width='264'
        height='280'>
        <path
          d='M12 160C12 226.274 65.7258 280 132 280C198.274 280 252 226.274 252 160H264V0H0V160H12Z'
          fill='white'
        />
      </mask>
      <g mask='url(#mask1)'>
        <mask
          id='mask2'
          mask-type='alpha'
          maskUnits='userSpaceOnUse'
          x='32'
          y='36'
          width='200'
          height='244'>
          <path
            d='M156 180.611V199H160C199.764 199 232 231.236 232 271V280H32V271C32 231.236 64.2355 199 104 199H108V180.611C90.7626 172.422 78.3722 155.687 76.3051 135.881C70.4803 135.058 66 130.052 66 124V110C66 104.054 70.3246 99.1181 76 98.1659V92C76 61.0721 101.072 36 132 36C162.928 36 188 61.0721 188 92V98.1659C193.675 99.1181 198 104.054 198 110V124C198 130.052 193.52 135.058 187.695 135.881C185.628 155.687 173.237 172.422 156 180.611Z'
            fill='white'
          />
        </mask>
        <g mask='url(#mask2)'>
          <path
            d='M156 180.611V199H160C199.764 199 232 231.236 232 271V280H32V271C32 231.236 64.2355 199 104 199H108V180.611C90.7626 172.422 78.3722 155.687 76.3051 135.881C70.4803 135.058 66 130.052 66 124V110C66 104.054 70.3246 99.1181 76 98.1659V92C76 61.0721 101.072 36 132 36C162.928 36 188 61.0721 188 92V98.1659C193.675 99.1181 198 104.054 198 110V124C198 130.052 193.52 135.058 187.695 135.881C185.628 155.687 173.237 172.422 156 180.611Z'
            fill='#D0C6AC'
          />
          <path d='M264 36H0V280H264V36Z' fill='#FFDBB4' />
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M188 115V138C188 168.928 162.928 194 132 194C101.072 194 76 168.928 76 138V115V130C76 160.928 101.072 186 132 186C162.928 186 188 160.928 188 130V115Z'
            fill='black'
            fillOpacity='0.1'
          />
        </g>
        <mask
          id='mask3'
          mask-type='alpha'
          maskUnits='userSpaceOnUse'
          x='32'
          y='183'
          width='200'
          height='97'>
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M108 183.071C90.0813 185.076 76.2798 190.552 76.0042 204.645C50.1464 215.568 32 241.165 32 271V280H232V271C232 241.165 213.854 215.568 187.996 204.645C187.72 190.552 173.919 185.076 156 183.071V202C156 215.255 145.255 226 132 226C118.745 226 108 215.255 108 202V183.071Z'
            fill='white'
          />
        </mask>
        <g mask='url(#mask3)'>
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M108 183.071C90.0813 185.076 76.2798 190.552 76.0042 204.645C50.1464 215.568 32 241.165 32 271V280H232V271C232 241.165 213.854 215.568 187.996 204.645C187.72 190.552 173.919 185.076 156 183.071V202C156 215.255 145.255 226 132 226C118.745 226 108 215.255 108 202V183.071Z'
            fill='#B7C1DB'
          />
          <path d='M264 170H0V280H264V170Z' fill='#384A55' />
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M103 232.739V281H96V229.15C98.2038 230.46 100.547 231.661 103 232.739ZM170 229.15V269.5C170 271.433 168.433 273 166.5 273C164.567 273 163 271.433 163 269.5V232.739C165.453 231.661 167.796 230.46 170 229.15Z'
            fill='#F4F4F4'
          />
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M90.9601 182.724C75.9093 185.571 65.5 191.243 65.5 202.308C65.5 222.02 98.5377 238 132 238C165.462 238 198.5 222.02 198.5 202.308C198.5 191.243 188.091 185.571 173.04 182.724C182.125 186.074 188 191.706 188 201.077C188 221.469 160.179 238 132 238C103.821 238 76 221.469 76 201.077C76 191.706 81.8751 186.074 90.9601 182.724Z'
            fill='black'
            fillOpacity='0.16'
          />
        </g>
        <mask
          id='mask4'
          mask-type='alpha'
          maskUnits='userSpaceOnUse'
          x='112'
          y='146'
          width='39'
          height='20'>
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M112.584 148.413C113.642 157.904 121.692 165.284 131.466 165.284C141.27 165.284 149.34 157.859 150.358 148.325C150.44 147.557 149.583 146.284 148.509 146.284C133.615 146.284 122.204 146.284 114.553 146.284C113.472 146.284 112.478 147.463 112.584 148.413Z'
            fill='white'
          />
        </mask>
        <animated.g mask='url(#mask4)' style={{ transform: xy.to(trans1) }}>
          <path
            fillRule='evenodd'
            clipRule='evenodd'
            d='M112.584 148.413C113.642 157.904 121.692 165.284 131.466 165.284C141.27 165.284 149.34 157.859 150.358 148.325C150.44 147.557 149.583 146.284 148.509 146.284C133.615 146.284 122.204 146.284 114.553 146.284C113.472 146.284 112.478 147.463 112.584 148.413Z'
            fill='black'
            fillOpacity='0.7'
          />
          <path
            d='M142.466 135.284H121.466C118.704 135.284 116.466 137.523 116.466 140.284V146.284C116.466 149.046 118.704 151.284 121.466 151.284H142.466C145.227 151.284 147.466 149.046 147.466 146.284V140.284C147.466 137.523 145.227 135.284 142.466 135.284Z'
            fill='white'
          />
          <path
            d='M126.466 179.284C132.541 179.284 137.466 174.36 137.466 168.284C137.466 162.209 132.541 157.284 126.466 157.284C120.391 157.284 115.466 162.209 115.466 168.284C115.466 174.36 120.391 179.284 126.466 179.284Z'
            fill='#FF4F6D'
          />
          <path
            d='M136.466 179.284C142.541 179.284 147.466 174.36 147.466 168.284C147.466 162.209 142.541 157.284 136.466 157.284C130.391 157.284 125.466 162.209 125.466 168.284C125.466 174.36 130.391 179.284 136.466 179.284Z'
            fill='#FF4F6D'
          />
        </animated.g>
        {/* <path */}
        <animated.path
          style={{ transform: xy.to(trans1) }}
          fillRule='evenodd'
          clipRule='evenodd'
          d='M119.466 129.284C119.466 133.703 124.838 137.284 131.466 137.284C138.093 137.284 143.466 133.703 143.466 129.284'
          fill='black'
          fillOpacity='0.16'
        />
        {/* <path */}
        <animated.path
          style={{ transform: xy.to(trans1) }}
          fillRule='evenodd'
          clipRule='evenodd'
          d='M91.626 111.732C93.4725 107.933 97.6302 105.284 102.463 105.284C107.279 105.284 111.425 107.914 113.281 111.692C113.833 112.814 113.048 113.732 112.256 113.052C109.805 110.944 106.325 109.628 102.463 109.628C98.723 109.628 95.3396 110.863 92.9034 112.856C92.0126 113.585 91.0859 112.843 91.626 111.732Z'
          fill='black'
          fillOpacity='0.6'
        />
        {/* <path */}
        <animated.path
          style={{ transform: xy.to(trans1) }}
          fillRule='evenodd'
          clipRule='evenodd'
          d='M149.626 111.732C151.472 107.933 155.63 105.284 160.463 105.284C165.28 105.284 169.425 107.914 171.281 111.692C171.833 112.814 171.048 113.732 170.256 113.052C167.805 110.944 164.325 109.628 160.463 109.628C156.723 109.628 153.34 110.863 150.903 112.856C150.013 113.585 149.086 112.843 149.626 111.732Z'
          fill='black'
          fillOpacity='0.6'
        />
        {/* <path */}
        <animated.path
          style={{ transform: xy.to(trans1) }}
          fillRule='evenodd'
          clipRule='evenodd'
          d='M102.013 87.4329C96.2062 87.7012 86.8181 91.9208 87.06 97.7767C87.068 97.9684 87.3495 98.0525 87.4871 97.9051C90.242 94.9458 109.802 91.9554 116.692 93.5401C117.323 93.6853 117.802 93.0633 117.402 92.6139C113.98 88.7657 107.216 87.1875 102.013 87.4329Z'
          fill='black'
          fillOpacity='0.6'
        />
        {/* <path */}
        <animated.path
          style={{ transform: xy.to(trans1) }}
          fillRule='evenodd'
          clipRule='evenodd'
          d='M161.918 87.4329C167.725 87.7012 177.114 91.9208 176.872 97.7767C176.864 97.9684 176.582 98.0525 176.445 97.9051C173.69 94.9458 154.129 91.9554 147.24 93.5401C146.609 93.6853 146.13 93.0633 146.529 92.6139C149.952 88.7657 156.716 87.1875 161.918 87.4329Z'
          fill='black'
          fillOpacity='0.6'
        />
        <mask
          id='mask5'
          mask-type='alpha'
          maskUnits='userSpaceOnUse'
          x='0'
          y='0'
          width='264'
          height='280'>
          <path d='M264 0H0V280H264V0Z' fill='white' />
        </mask>
        <g mask='url(#mask5)'>
          <mask
            id='mask6'
            mask-type='alpha'
            maskUnits='userSpaceOnUse'
            x='72'
            y='9'
            width='121'
            height='91'>
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M93.2519 52.0221C93.3749 51.9677 93.0697 51.9468 92.3361 51.9595C93.2277 51.9577 93.5329 51.9785 93.2519 52.0221ZM85.117 36.3016C85.1148 36.282 85.1338 36.4527 85.117 36.3016V36.3016ZM192.765 70.7657C192.501 67.4487 192.033 64.1519 191.247 60.9111C190.622 58.3354 189.769 55.8775 188.76 53.42C188.151 51.9354 186.728 49.8961 186.56 48.2945C186.395 46.7169 187.627 44.9691 187.889 43.1323C188.144 41.3448 188.101 39.4652 187.734 37.6939C186.901 33.671 184.14 29.93 179.877 28.8814C178.925 28.6472 176.913 28.9358 176.241 28.3816C175.47 27.746 174.933 25.5807 174.235 24.7122C172.244 22.2362 169.14 20.6417 165.866 21.1976C163.455 21.6068 164.839 22.1053 163.032 20.6864C162.027 19.8976 161.276 18.6932 160.3 17.8392C158.833 16.5564 157.15 15.4582 155.408 14.557C150.851 12.1989 145.654 10.4849 140.564 9.64943C131.279 8.12524 121.369 9.45409 112.369 11.8688C107.89 13.0703 103.382 14.5952 99.2221 16.6118C97.4386 17.4764 96.409 18.1936 94.5495 18.4201C91.6207 18.7767 89.1405 18.7589 86.3661 20.001C77.8298 23.8229 73.9849 32.6898 77.3067 41.175C77.9748 42.8816 78.8795 44.3802 80.1267 45.7586C81.6475 47.4393 82.1976 47.1085 80.8878 49.0412C78.929 51.9312 77.2777 55.0129 75.9333 58.2129C72.4043 66.6146 71.8138 76.0772 72.0436 85.0373C72.124 88.1741 72.2586 91.3495 72.7532 94.4562C72.9668 95.8009 73.0267 98.3293 74.0354 99.3271C74.5471 99.8331 75.2762 100.115 76.0036 99.9138C77.7131 99.4402 77.1253 98.1787 77.165 97.0076C77.3649 91.124 77.095 85.9191 78.4943 80.1065C79.5279 75.8119 81.2505 71.9115 83.4828 68.0714C86.3214 63.1872 89.3857 58.8977 93.2895 54.7155C94.2073 53.732 94.4079 53.3151 95.6386 53.2438C96.5705 53.19 97.9338 53.8282 98.8399 54.0492C100.838 54.5361 102.839 55.0174 104.873 55.3453C108.613 55.9482 112.317 55.9886 116.09 55.8704C123.516 55.6381 130.975 55.1172 138.175 53.2471C142.957 52.0054 147.197 49.7762 151.777 48.1422C151.859 48.1131 153.007 47.2951 153.208 47.3285C153.489 47.3748 155.185 49.1543 155.471 49.3784C157.697 51.1239 160.138 51.8567 162.541 53.2082C165.505 54.8746 162.635 52.49 164.269 54.5668C164.746 55.1716 164.99 56.2932 165.372 56.9783C166.588 59.1611 168.28 61.0795 170.303 62.6018C172.258 64.0725 175.196 64.7829 176.193 66.6972C176.962 68.1741 177.221 70.1813 177.841 71.7579C179.469 75.8932 181.618 79.7495 183.767 83.6443C185.499 86.7831 187.392 89.525 187.585 93.1118C187.652 94.3603 186.464 101.849 189.358 99.5717C189.786 99.2341 190.711 95.4157 190.901 94.7678C191.673 92.1351 191.947 89.3867 192.296 86.6817C192.99 81.3022 193.219 76.1837 192.765 70.7657Z'
              fill='white'
            />
          </mask>
          <g mask='url(#mask6)'>
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M93.2519 52.0221C93.3749 51.9677 93.0697 51.9468 92.3361 51.9595C93.2277 51.9577 93.5329 51.9785 93.2519 52.0221ZM85.117 36.3016C85.1148 36.282 85.1338 36.4527 85.117 36.3016V36.3016ZM192.765 70.7657C192.501 67.4487 192.033 64.1519 191.247 60.9111C190.622 58.3354 189.769 55.8775 188.76 53.42C188.151 51.9354 186.728 49.8961 186.56 48.2945C186.395 46.7169 187.627 44.9691 187.889 43.1323C188.144 41.3448 188.101 39.4652 187.734 37.6939C186.901 33.671 184.14 29.93 179.877 28.8814C178.925 28.6472 176.913 28.9358 176.241 28.3816C175.47 27.746 174.933 25.5807 174.235 24.7122C172.244 22.2362 169.14 20.6417 165.866 21.1976C163.455 21.6068 164.839 22.1053 163.032 20.6864C162.027 19.8976 161.276 18.6932 160.3 17.8392C158.833 16.5564 157.15 15.4582 155.408 14.557C150.851 12.1989 145.654 10.4849 140.564 9.64943C131.279 8.12524 121.369 9.45409 112.369 11.8688C107.89 13.0703 103.382 14.5952 99.2221 16.6118C97.4386 17.4764 96.409 18.1936 94.5495 18.4201C91.6207 18.7767 89.1405 18.7589 86.3661 20.001C77.8298 23.8229 73.9849 32.6898 77.3067 41.175C77.9748 42.8816 78.8795 44.3802 80.1267 45.7586C81.6475 47.4393 82.1976 47.1085 80.8878 49.0412C78.929 51.9312 77.2777 55.0129 75.9333 58.2129C72.4043 66.6146 71.8138 76.0772 72.0436 85.0373C72.124 88.1741 72.2586 91.3495 72.7532 94.4562C72.9668 95.8009 73.0267 98.3293 74.0354 99.3271C74.5471 99.8331 75.2762 100.115 76.0036 99.9138C77.7131 99.4402 77.1253 98.1787 77.165 97.0076C77.3649 91.124 77.095 85.9191 78.4943 80.1065C79.5279 75.8119 81.2505 71.9115 83.4828 68.0714C86.3214 63.1872 89.3857 58.8977 93.2895 54.7155C94.2073 53.732 94.4079 53.3151 95.6386 53.2438C96.5705 53.19 97.9338 53.8282 98.8399 54.0492C100.838 54.5361 102.839 55.0174 104.873 55.3453C108.613 55.9482 112.317 55.9886 116.09 55.8704C123.516 55.6381 130.975 55.1172 138.175 53.2471C142.957 52.0054 147.197 49.7762 151.777 48.1422C151.859 48.1131 153.007 47.2951 153.208 47.3285C153.489 47.3748 155.185 49.1543 155.471 49.3784C157.697 51.1239 160.138 51.8567 162.541 53.2082C165.505 54.8746 162.635 52.49 164.269 54.5668C164.746 55.1716 164.99 56.2932 165.372 56.9783C166.588 59.1611 168.28 61.0795 170.303 62.6018C172.258 64.0725 175.196 64.7829 176.193 66.6972C176.962 68.1741 177.221 70.1813 177.841 71.7579C179.469 75.8932 181.618 79.7495 183.767 83.6443C185.499 86.7831 187.392 89.525 187.585 93.1118C187.652 94.3603 186.464 101.849 189.358 99.5717C189.786 99.2341 190.711 95.4157 190.901 94.7678C191.673 92.1351 191.947 89.3867 192.296 86.6817C192.99 81.3022 193.219 76.1837 192.765 70.7657Z'
              fill='black'
            />
            <path d='M263 0H-1V280H263V0Z' fill='black' />
          </g>
        </g>
      </g>
    </animated.svg>
  );
};

export default Avatar;
